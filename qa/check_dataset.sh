#!/bin/bash

PERIOD=LHC16h

# For merged Aod
FILEPATH="AOD/*"

# For non-merged Aod
# FILEPATH="*.*"


function dump_run()
{
    alien_find /alice/data/2016/$PERIOD/000$1/muon_calo_pass1/$FILEPATH/ -z  -name AliAOD.root
}

# Here is how we find band and/or good runs
function run_has_data()
{
    echo $1
    if (( $(dump_run $1 | wc -l) > 1 )); then
        echo $I >> good-runs-$PERIOD.log
    else
        echo "A bad run has been found: " $I
        echo $I >> bad-runs-$PERIOD.log
    fi
}


# LHC16h
runs=(255469 255467 255466 255465 255463 255447 255442 255440 255421 255420 255419 255418 255415 255407 255402 255398 255352 255351 255350 255283 255280 255278 255276 255275 255256 255255 255253 255252 255251 255249 255248 255247 255242 255240 255211 255210 255182 255181 255180 255177 255176 255174 255173 255171 255167 255162 255159 255154 255138 255136 255135 255111 255091 255086 255085 255082 255079 255076 255075 255074 255073 255071 255070 255068 255042 255039 255011 255010 255009 255008 254984 254983 254933 254915 254914 254892 254877 254857 254854 254849 254848 254846 254766 254761 254750 254735 254706 254704 254701 254691 254673 254670 254654 254653 254652 254651 254649 254648 254646 254644 254640 254632 254630 254629 254628 254627 254621 254619 254608 254607 254606 254604 254589 254586 254581 254578 254577 254576 254568 254564 254559 254553 254530 254529 254495 254487 254479 254476 254475 254422 254419 254418 254396 254395 254394 254381 254378)

# LHC16i
#runs=(255650 255649 255648 255642 255639 255618 255617 255616 255615 255614 255592 255591 255590 255589 255587 255586 255585 255584 255583 255582 255581 255580 255579 255578 255577 255558 255543 255542 255541 255540 255539 255538 255537 255536 255535 255534 255533 255515)
# runs=(255650 255649 255648 255642 255639 255616 255615 255614 255592 255591 255582 255577 255558 255543 255542 255540 255538 255537 255535 255534 255533 255515)

# LHC16j
#runs=(256420 256419 256418 256417 256415 256373 256372 256371 256370 256368 256367 256366 256365 256364 256363 256362 256361 256357 256356 256355 256311 256309 256307 256306 256302 256299 256298 256297 256295 256294 256293 256292 256291 256290 256289 256287 256286 256285 256284 256283 256282 256281 256280 256279 256261 256231 256230 256228 256227 256226 256225 256224 256223 256222 256219 256215 256213 256212 256211 256210 256207 256204 256169 256166 256165 256162 256161 256158 256157 256156 256155 256154 256152 256151 256150 256149 256148 256147 256146 256145)

# determine good and bad runs
for I in ${runs[*]}; do
    run_has_data $I
done


# Show that bad runs have no files indeed
while read run; do
    dump_run $run
done < bad-runs-$PERIOD.log

