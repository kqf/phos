#!/bin/bash

PERIOD=LHC16i

# For merged Aod
FILEPATH="AOD/*"

# For non-merged Aod
# FILEPATH="*.*"


function dump_run()
{
    alien_find /alice/data/2016/$PERIOD/000$1/muon_calo_pass1/$FILEPATH/ -z  -name AliAOD.root
}

# Here is how we find band and/or good runs
function run_has_data()
{
    echo $1
    if (( $(dump_run $1 | wc -l) > 1 )); then
        echo $I >> good-runs-$PERIOD.log
    else
        echo "A bad run has been found: " $I
        echo $I >> bad-runs-$PERIOD.log
    fi
}


# LHC16h
# runs=(254378 254381 254394 254395 254396 254419 254422 254476 254479 254487 254495 254529 254564 254568 254576 254577 254578 254581 254586 254589 254604 254606 254607 254608 254621 254629 254630 254632 254640 254644 254646 254648 254649 254653 254654 254670 254673 254691 254701 254704 254706 254735 254750 254761 254766 254846 254848 254854 254857 254877 254914 254915 254983 254984 255008 255009 255010 255042 255068 255071 255073 255074 255075 255076 255079 255082 255085 255086 255091 255111 255135 255136 255138 255154 255159 255162 255167 255171 255173 255176 255177 255180 255182 255240 255242 255247 255248 255249 255251 255252 255253 255255 255256 255275 255276 255278 255280 255283 255350 255351 255352 255398 255402 255407 255440 255442 255447 255463 255465 255466 255467)

# LHC16i
runs=(255650 255649 255648 255642 255639 255618 255617 255616 255615 255614 255592 255591 255590 255589 255587 255586 255585 255584 255583 255582 255581 255580 255579 255578 255577 255558 255543 255542 255541 255540 255539 255538 255537 255536 255535 255534 255533 255515)
# runs=(255650 255649 255648 255642 255639 255616 255615 255614 255592 255591 255582 255577 255558 255543 255542 255540 255538 255537 255535 255534 255533 255515)

# determine good and bad runs
for I in ${runs[*]}; do
    run_has_data $I
done


# Show that bad runs have no files indeed
while read run; do
    dump_run $run
done < bad-runs-$PERIOD.log

